
<template name="stagePage">
  {{>navbar}}
  {{setTitle this}}
  {{log this}}
  <div class="container-fluid">
    <h3>Details for Stage {{stageId}}, Attempt {{attemptId}}</h3>
    {{#with stageAttempt.metrics}}
      <div><strong>Total time across all tasks:</strong> {{formatTime ExecutorRunTime}}</div>

      {{#with InputMetrics}}
        {{#if BytesRead}}
        <div>
          <strong>Input Size / Records:</strong> {{formatBytes BytesRead}} / {{RecordsRead}} records
        </div>
        {{/if}}
      {{/with}}

      {{#with OutputMetrics}}
        {{#if BytesWritten}}
        <div>
          <strong>Output Size / Records:</strong> {{formatBytes BytesWritten}} / {{RecordsWritten}} records
        </div>
        {{/if}}
      {{/with}}

      {{#with ShuffleReadMetrics}}
        {{#if shuffleBytesRead this}}
        <div>
          <strong>Shuffle read:</strong> {{shuffleBytesReadStr this}} / {{TotalRecordsRead}} records
        </div>
        {{/if}}
      {{/with}}

      {{#with ShuffleWriteMetrics}}
        {{#if ShuffleBytesWritten}}
        <div>
          <strong>Shuffle write:</strong> {{formatBytes ShuffleBytesWritten}} / {{ShuffleRecordsWritten}} records
        </div>
        {{/if}}
      {{/with}}
    {{/with}}

    <div>
      {{>React component=SummaryMetricsTable stats=stats}}
    </div>
    <div>
      {{>React component=StageExecutorsTable stageId=stageId attemptId=attemptId}}
    </div>
    <div>
      {{>React component=TasksTable}}
    </div>
  </div>
</template>


<template name="taskRow-errors">
  {{>fetchFailure end}}
  {{>exceptionFailure end}}
  {{>executorLostFailure end}}
</template>

<template name="fetchFailure">
  {{#if fetchFailure reason}}
    Fetch Failed, {{>hostPort BlockManagerAddress}}: {{message}}<br/>
    Shuffle ID: {{ShuffleID}}<br/>
    Map ID: {{MapID}}<br/>
    Reduce ID: {{ReduceID}}
  {{/if}}
</template>

<template name="exceptionFailure">
  {{#if exceptionFailure reason}}
    {{ClassName}}: {{Description}}<br/>
    {{FullStackTrace}}
    {{>stackTrace StackTrace}}
  {{/if}}
</template>

<template name="stackTrace">
  {{#each this}}
    {{DeclaringClass}}.{{MethodName}} ({{FileName}}:{{LineNumber}})
  {{/each}}
</template>

<template name="executorLostFailure">
  {{#if executorLostFailure reason}}
    {{reason}}: {{ExecutorID}} ({{getHostPort ExecutorID}}
  {{/if}}
</template>

