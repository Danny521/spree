
<template name="stagesTables">
  {{#if numActiveStages}}<div><a href="#active"><strong>Active Stages:</strong></a> {{numActiveStages}}</div>{{/if}}
  {{#if numPendingStages}}<div><a href="#pending"><strong>Pending Stages:</strong></a> {{numPendingStages}}</div>{{/if}}
  {{#if numCompletedStages}}<div><a href="#completed"><strong>Completed Stages:</strong></a> {{numCompletedStages}}</div>{{/if}}
  {{#if numSkippedStages}}<div><a href="#skipped"><strong>Skipped Stages:</strong></a> {{numSkippedStages}}</div>{{/if}}
  {{#if numActiveStages}}
    <h4 id="active">Active Stages ({{numActiveStages}})</h4>
    {{>stagesTable stages=activeStages appId=appId}}
  {{/if}}
  {{#if numPendingStages}}
    <h4 id="pending">Pending Stages ({{numPendingStages}})</h4>
    {{>stagesTable stages=pendingStages appId=appId}}
  {{/if}}
  {{#if numCompletedStages}}
    <h4 id="completed">Completed Stages ({{numCompletedStages}})</h4>
    {{>stagesTable stages=completedStages appId=appId}}
  {{/if}}
  {{#if numSkippedStages}}
    <h4 id="skipped">Skipped Stages ({{numSkippedStages}})</h4>
    {{>stagesTable stages=skippedStages appId=appId}}
  {{/if}}
</template>

<template name="stagesTable">
  <table class="table table-bordered table-striped table-condensed sortable">
    <thead>
    <tr>
      {{#each columns}}
        <th>{{label}}</th>
      {{/each}}
    </tr>
    </thead>
    <tbody>
    {{#each stages}}
      {{#with stage=stage attempt=attempt appId=../appId}}
        <tr>
          {{#each columns}}
            <td>
              {{> Template.dynamic template=getTemplateName data=..}}
            </td>
          {{/each}}
        </tr>
      {{/with}}
    {{/each}}
    </tbody>
  </table>
</template>

<template name="stageRow-id">
  {{stage.id}}
</template>

<template name="stageRow-desc">
  <a href="/a/{{appId}}/stage/{{stage.id}}?attempt={{attempt.id}}">{{stage.name}}</a>
</template>

<template name="stageRow-start">
  {{formatDateTime attempt.time.start}}
</template>

<template name="stageRow-duration">
  {{#with attempt.time}}{{formatDuration start end}}{{/with}}
</template>

<template name="stageRow-tasks">
  {{> progressBar attempt.taskCounts}}
</template>

<template name="stageRow-input">
  {{formatBytes attempt.metrics.InputMetrics.BytesRead}}
</template>

<template name="stageRow-output">
  {{formatBytes attempt.metrics.OutputMetrics.BytesWritten}}
</template>

<template name="stageRow-shuffle-read">
  {{shuffleBytesReadStr attempt.metrics.ShuffleReadMetrics}}
</template>

<template name="stageRow-shuffle-write">
  {{formatBytes attempt.metrics.ShuffleWriteMetrics.ShuffleBytesWritten}}
</template>

